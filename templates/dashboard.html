{% extends "base.html" %} {% block title %}Lecturer Dashboard{% endblock %} {% block content %}
<div class="container py-4">

    <!-- Logo Section -->
    <div class="text-center mb-4">
        {% if user and user.logo_filename %}
        <img src="{{ url_for('static', filename='uploads/logos/' ~ user.logo_filename) }}" alt="School Logo" class="img-fluid mb-2" style="max-height: 120px;"> {% elif session.get('lecturer_logo') %}
        <img src="{{ url_for('static', filename=session['lecturer_logo'].replace('static/', '')) }}" alt="School Logo" class="img-fluid mb-2" style="max-height: 120px;"> {% else %}
        <p class="text-muted">
            No logo uploaded yet.
            <a href="{{ url_for('upload_logo') }}">Upload one</a>
        </p>
        {% endif %}
    </div>

    <!-- Dashboard Title -->
    <h1 class="mb-4 text-center">
        <i class="fas fa-tachometer-alt me-2"></i> Lecturer Dashboard
    </h1>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-md-6 mb-3">
            <div class="card shadow-sm border-start border-primary border-3 h-100">
                <div class="card-body text-center">
                    <i class="fas fa-list-alt fa-2x text-primary mb-2"></i>
                    <h5 class="card-title">Total Sessions</h5>
                    <p class="display-6 fw-bold">{{ total_sessions }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-3">
            <div class="card shadow-sm border-start border-success border-3 h-100">
                <div class="card-body text-center">
                    <i class="fas fa-user-check fa-2x text-success mb-2"></i>
                    <h5 class="card-title">Total Attendance Records</h5>
                    <p class="display-6 fw-bold">{{ total_attendance }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Session Table -->
    <div class="dashboard-section mb-4">
        <h2 class="mb-3">
            <i class="fas fa-list-alt me-2"></i> Recent Attendance Sessions
        </h2>

        {% if sessions %}
        <div class="table-responsive">
            <table class="table table-hover align-middle shadow-sm">
                <thead class="table-primary">
                    <tr>
                        <th>Session ID</th>
                        <th>Status</th>
                        <th>Latitude</th>
                        <th>Longitude</th>
                        <th>Radius (m)</th>
                        <th>Created</th>
                    </tr>
                </thead>
                <tbody>
                    {% for s in sessions %}
                    <tr>
                        <td>{{ s.session_id }}</td>
                        <td>
                            <span class="badge 
                                    {% if s.status == 'active' %}bg-success
                                    {% elif s.status == 'paused' %}bg-warning
                                    {% else %}bg-danger{% endif %}">
                                    {{ s.status|capitalize }}
                                </span>
                        </td>
                        <td>{{ s.latitude or 'N/A' }}</td>
                        <td>{{ s.longitude or 'N/A' }}</td>
                        <td>{{ s.radius or 0 }}</td>
                        <td>{{ moment(s.created_at).calendar() if s.created_at else 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i> No sessions have been created yet.
        </p>
        {% endif %}
    </div>

    <!-- Actions -->
    <div class="text-center mt-4">
        <a href="{{ url_for('upload_logo') }}" class="btn btn-secondary btn-lg me-3">
            <i class="fas fa-image me-2"></i> Upload Logo
        </a>
        <a href="{{ url_for('logout') }}" class="btn btn-danger btn-lg">
            <i class="fas fa-sign-out-alt me-2"></i> Logout
        </a>
    </div>
</div>
{% endblock %}